{"version":3,"sources":["./src/app/Services/cta-corrientes.service.ts","./src/app/Services/movimientos.service.ts","./src/app/models/ctacorriente.ts","./src/app/models/movimientoCaja.ts"],"names":[],"mappings":"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","file":"default~details-caja-details-caja-module~details-pedido-details-pedido-module~details-pedido-woocomm~5b23cef0.js","sourcesContent":["import { Injectable } from '@angular/core';\nimport { AngularFirestore } from 'angularfire2/firestore';\nimport * as firebase from 'firebase';\nimport { CtaCorriente } from '../models/ctacorriente';\nimport { ClientesService } from './clientes.service';\nimport { MovimientoCtaCorriente } from '../models/movimientoCtaCorriente';\nimport { MovimientoCaja } from '../models/movimientoCaja';\nimport { CajasService } from './cajas.service';\nimport { BaseService } from './base.service';\nimport { ComerciosService } from './comercios.service';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class CtaCorrientesService extends BaseService {\n\n  \n  constructor(\n    private firestore: AngularFirestore,\n    private clientesService:ClientesService,\n    private comerciosService:ComerciosService\n    ) {     \n      super(firestore); \n      this.comerciosService.getSelectedCommerce().subscribe(data=>{\n        // let comercio_seleccionadoId = localStorage.getItem('comercio_seleccionadoId'); \n        if(data){\n          \n          this.setPath('comercios/'+data.id+'/ctascorrientes')   \n         }\n        \n      })\n  }\n\n  \n  public create(data:CtaCorriente) {   \n\n    data.id = this.firestore.createId();\n\n    const param = JSON.parse(JSON.stringify(data));\n    this.firestore.collection(this.path).add({...param,\n      createdAt: firebase.firestore.FieldValue.serverTimestamp(),\n    });  \n    \n    data.coTitularesId.forEach(element => {\n      this.clientesService.addCtaCorriente(element,data.id);\n    });\n    \n  }\n\n  public get(documentId: string) {\n    return this.firestore.collection(this.path).doc(documentId).snapshotChanges();\n  }\n\n  public getByComercioCliente(cliente){\n    let comercio_seleccionadoId = localStorage.getItem('comercio_seleccionadoId');\n    return this.firestore.collection(this.path, ref => \n        ref.where('coTitularesId','array-contains',cliente.id)).snapshotChanges();\n  }\n\n\n  public getByCliente(clienteId){\n    return this.firestore.collection(this.path, ref => \n        ref.where('coTitularesId','array-contains',clienteId)).snapshotChanges();\n  }\n\n\n  public getByClienteId(id) {   \n    return this.firestore.collection(this.path, ref =>ref.where(id,\"==\",\"clienteId\")).snapshotChanges();\n  } \n \n \n\n}\n","import { Injectable } from '@angular/core';\nimport { AngularFirestore } from 'angularfire2/firestore';\nimport { CtaCorrientesService } from './cta-corrientes.service';\nimport { CajasService } from './cajas.service';\nimport { MovimientoCaja } from '../models/movimientoCaja';\nimport * as firebase from 'firebase';\nimport { MovimientoCtaCorriente } from '../models/movimientoCtaCorriente';\nimport { Mock } from 'protractor/built/driverProviders';\nimport { Caja } from '../models/caja';\nimport { CtaCorriente } from '../models/ctacorriente';\nimport { BaseService } from './base.service';\nimport { ComerciosService } from './comercios.service';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class MovimientosService extends BaseService {\n\n  private comercioId = \"\";\n  constructor(\n    protected afs: AngularFirestore,\n    private ctaCorrienteService:CtaCorrientesService,\n    private cajasService:CajasService,\n    private comerciosService:ComerciosService\n    ) {     \n      super(afs); \n      this.comerciosService.getSelectedCommerce().subscribe(data=>{\n        // let comercio_seleccionadoId = localStorage.getItem('comercio_seleccionadoId'); \n        if(data){\n          \n          this.comercioId = data.id\n           \n         }\n        \n      })\n  }\n\n\n  setearPath(cajaId){\n      this.setPath('comercios/'+this.comercioId+'/cajas/'+cajaId+'/movimientos')   \n  }\n\n  getMovimientoCaja(cajaId,movId){\n    return this.afs.collection('comercios/'+this.comercioId+'/cajas/'+cajaId+'/movimientos').doc(movId).snapshotChanges();\n  }\n\n  getMovimientoCtaCorriente(ctaCorrienteId,movId,fechaDesde){\n    return this.afs.collection('comercios/'+this.comercioId+'/ctascorrientes/'+ctaCorrienteId+'/movimientos',ref=>ref.where('createdAt', '>=', fechaDesde).orderBy('createdAt',\"desc\")).doc(movId).snapshotChanges();\n  }\n\n \n  public getMovimientosCaja(cajaId,fechaDesde){\n    return this.afs.collection('comercios/'+this.comercioId+'/cajas/'+cajaId+'/movimientos',ref=>ref.where('createdAt', '>=', fechaDesde).orderBy('createdAt',\"desc\")).snapshotChanges();\n  }\n\n\n  \n\n  eliminarMovimientoCaja(caja:Caja,data:MovimientoCaja){  \n\n    this.afs.collection('comercios/'+this.comercioId+'/cajas/'+data.cajaId+'/movimientos').doc(data.id).delete();\n      \n    this.restarTotalCaja(data.cajaId,data.metodoPago,data.monto);\n\n    if(data.depositoId != \"\"){  \n      console.log(\"Eliminando Deposito también \"+data.ctaCorrienteId+\" \"+data.depositoId)\n      this.restarTotalCtaCorriente(data.ctaCorrienteId,data.monto);       \n      this.afs.collection('comercios/'+this.comercioId+'/ctascorrientes/'+data.ctaCorrienteId+'/movimientos').doc(data.depositoId).delete();\n    }\n\n    if(data.extraccionId != \"\"){  \n      console.log(\"Eliminando Extracción también \"+data.ctaCorrienteId+\" \"+data.extraccionId)\n      this.restarTotalCtaCorriente(data.ctaCorrienteId,data.monto);       \n      this.afs.collection('comercios/'+this.comercioId+'/ctascorrientes/'+data.ctaCorrienteId+'/movimientos').doc(data.extraccionId).delete();\n    }\n\n  }\n\n  \n \n  public restarTotalCaja(cajaId,metodo,monto){       \n      \n    const sfDocRef = this.afs.firestore.collection('comercios/'+this.comercioId+'/cajas').doc(cajaId);\n    \n      this.afs.firestore.runTransaction(transaction => \n        // This code may get re-run multiple times if there are conflicts.\n        transaction.get(sfDocRef)\n        .then(sfDoc => {\n          // const newPopulation = sfDoc.data().population + 1;\n          if(metodo == \"efectivo\"){\n            transaction.update(sfDocRef, { totalEfectivo: sfDoc.data().totalEfectivo - monto });\n          }\n          if(metodo == \"debito\"){\n            transaction.update(sfDocRef, { totalDebito: sfDoc.data().totalDebito - monto });\n          }\n          if(metodo == \"credito\"){\n            transaction.update(sfDocRef, { totalCredito: sfDoc.data().totalCredito - monto });\n          }\n  \n          if(metodo ==\"ctaCorriente\"){\n            transaction.update(sfDocRef, { totalCtaCorriente: sfDoc.data().totalCtaCorriente - monto });\n          }\n  \n        }))\n    }\n\n    public getMovimientosCtaCorriente(ctaCorrienteId){\n      return this.afs.collection('comercios/'+this.comercioId+'/ctascorrientes/'+ctaCorrienteId+'/movimientos/', ref=>ref.orderBy('createdAt',\"desc\").limit(10)).snapshotChanges();\n    }  \n    \n  \n    public restarTotalCtaCorriente(ctaCorrienteId,monto){\n        \n        const sfDocRef = this.afs.firestore.collection('comercios/'+this.comercioId+'/ctascorrientes').doc(ctaCorrienteId);\n      \n        this.afs.firestore.runTransaction(transaction => \n          // This code may get re-run multiple times if there are conflicts.\n          transaction.get(sfDocRef)\n          .then(sfDoc => {\n            // const newPopulation = sfDoc.data().population + 1;\n           \n            transaction.update(sfDocRef, { montoTotal: sfDoc.data().montoTotal - monto });\n            \n    \n          }))\n    }\n  \n    crearMovimientoCtaCorriente(data:MovimientoCtaCorriente){\n\n      console.log(data.ctaCorrienteId)\n     \n      this.afs.firestore.collection('comercios/'+this.comercioId+'/ctascorrientes').doc(data.ctaCorrienteId).get().then(doc=>{\n      \n       \n        let cta:CtaCorriente = new CtaCorriente(\"\",\"\");\n        cta.asignarValores(doc.data())\n        cta.id = doc.id;  \n        data.fotoCtaCorriente = doc.data();\n        cta.montoTotal = Number(cta.montoTotal) + Number(data.monto);  \n        \n        const param1 = JSON.parse(JSON.stringify(cta));\n        this.ctaCorrienteService.update(param1).then(data=>{\n          \n        });\n\n        \n        const param2 = JSON.parse(JSON.stringify(data));\n        this.afs.collection('comercios/'+this.comercioId+'/ctascorrientes/'+data.ctaCorrienteId+'/movimientos').doc(data.id).set({...param2,\n          createdAt: firebase.firestore.FieldValue.serverTimestamp(),\n        });\n  \n      })\n  \n    }\n  \n    eliminarMovimientoCtaCorriente(data:MovimientoCtaCorriente){  \n  \n\n      this.restarTotalCtaCorriente(data.ctaCorrienteId,data.monto);\n      console.log(data)\n      \n      if(data.pagoId != \"\"){\n        console.log(\"Eliminando Pago también\"+data.cajaId+\" \"+data.pagoId);\n\n       /* this.cajasService.get(this.comercioId,data.cajaId).subscribe(snap=>{\n          var caja:Caja = new Caja();\n          caja.asignarValores(snap.payload.data())\n          caja.id = snap.payload.id;*/\n          this.restarTotalCaja(data.cajaId,data.metodoPago,data.monto);\n          this.afs.collection('comercios/'+this.comercioId+'/cajas/'+data.cajaId+'/movimientos').doc(data.pagoId).delete();\n        //})        \n      }\n  \n      const param = JSON.parse(JSON.stringify(data));\n      this.afs.collection('comercios/'+this.comercioId+'/ctascorrientes/'+data.ctaCorrienteId+'/movimientos').doc(data.id).delete();\n    } \n    \n\n  }\n\n","\r\nimport { MovimientoCtaCorriente } from './movimientoCtaCorriente';\r\n\r\nexport class CtaCorriente{\r\n    public id =\"\";\r\n    public comercioId= localStorage.getItem('comercio_seleccionadoId');   \r\n    public nombre=\"\";\r\n    public coTitularesId=[];\r\n    public montoActual=0;\r\n    public montoTotal =0;\r\n\r\n    public comercios = [];\r\n    public clientes =[];\r\n\r\n\r\n\tconstructor(\r\n        public vendedorId:\"\", \r\n        public vendedorNombre:\"\"\r\n\t\t){\r\n    }\r\n    \r\n    public asignarValores(init?: Partial<CtaCorriente>) {\r\n        Object.assign(this, init);\r\n    }\r\n}","export enum EnumTipoMovimientoCaja {\r\n    ingreso = 1, \r\n    egreso = 2, \r\n    devolucion = 3,  \r\n    pago = 4,\r\n    apertura = 5, \r\n    cierre = 6\r\n}\r\n\r\n\r\nexport class MovimientoCaja{\r\n\r\n    public id =\"\";\r\n    public clienteId = \"\";\r\n    public servicioId =\"\";\r\n    public cajaId =\"\";\r\n    public metodoPago =\"\";    \r\n    public monto=0;\r\n    public motivo=\"\";\r\n    public ventaId=\"\";\r\n    public pagareId =\"\";\r\n    public ctaCorrienteId =\"\";    \r\n    public depositoId=\"\";\r\n    public extraccionId=\"\";\r\n    public createdAt = new Date();\r\n    public isCierre = false;\r\n    public isApertura = false;\r\n    public fotoCaja:any; //Estado de la caja al momento de realizar el movimiento\r\n\r\n    public tipo\r\n\r\n\tconstructor(\r\n\t\tpublic vendedorId:\"\", \r\n        public vendedorNombre:\"\"\r\n\t\t){\r\n    }\r\n    \r\n    public asignarValores(init?: Partial<MovimientoCaja>) {\r\n        Object.assign(this, init);\r\n    }\r\n}"],"sourceRoot":"webpack:///"}